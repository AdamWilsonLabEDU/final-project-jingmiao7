---
title: "Phenology of Mangroves"
author: Jing Miao
subtitle: "Fall 2024 GEO 511 Final Project"
date: today
date-format: long
#bibliography: references.bib
output:
  html_document:
    mathjax: true
    toc: true
  pdf_document:
    latex_engine: xelatex
    toc: true
---

# Introduction

**Mangrove forests** are salt-tolerant trees and shrubs that thrive in intertidal zones of tropical and subtropical regions. These ecosystems are highly valued as blue carbon reservoirs and natural coastal protection systems. Within mangrove ecosystems, different species display significant diversity in tree structures, growth strategies, and environmental adaptations. While mangroves are evergreen, remote sensing observations reveal that distinct species exhibit varying temporal patterns in the onset, persistence, and greenness of their growth stages.<br> This study aims to characterize the phenological patterns of three mangrove species: **red mangrove** (*Rhizophora mangle*), **white mangrove** (*Avicennia germinans*), and **black mangrove** (*Laguncularia racemosa*) in Everglades National Park, Florida. To be more specific, high-temporal-resolution remote sensing data from the Harmonized Landsat and Sentinel (HLS) dataset for 2023 will be used to extract Normalized Difference Vegetation Index (NDVI) values, enabling a detailed analysis of the phenological differences among these dominant species.<br>
test
![**Figure 1.** Three Dominant mangrove species in South Florida and their zonation.](/data/dominant-mangrove-species-of-south-florida.png)

# Materials and methods

To extract phenological information of three mangrove species from remote sensing-based observation, we need:

-   **Datasets**
1.  **Harmonized Landsat and Sentinel (HLS) dataset**<br> The HLS product integrates data from the Landsat 8 (or Landsat 9) and Sentinel-2A (or Sentinel-2B) satellites, producing a harmonized surface reflectance dataset with a 30-meter spatial resolution. Moreover, HLS includes a Quality Assurance (QA) band, which provides data quality filters and masks for clouds, cloud shadows, and water bodies. **To generate time series NDVI from HLS dataset, red and near inf-red bands are collected.**

2.  **Geographical location of mangrove samples**<br> The geographical information of three mangrove species are collected from Project: The Vegetation of Everglades National Park: Final Report (Spatial Data). This project provides the vegetation map of everglades national park based on aerial photos and field samples as shown in Figure 2. **10 samples of each three mangrove species (red mangrove, white mangrove, and black mangrove) are extracted from this final report.**
-  **Methods**
1.  **Normalized Difference Vegetation Index**<br>
NDVI is widely used to monitor vegetation health and phenological changes over time. The formula is:<br>
<div style="text-align: center;">
$$
\text{NDVI} = \frac{(NIR - RED)}{(NIR + RED)}
$$
</div><br>
2.  **Harmonic Regression**<br>
Harmonic regression is a statistical technique that fits sine and cosine functions to data and is adept at identifying and modeling the cyclical variations inherent in time series with periodic patterns.<br>
<div style="text-align: center;">
$$
y_t = \beta_0 + \sum_{k=1}^{K} \left( \beta_{k} \cos\left(\frac{2\pi k t}{T}\right) + \gamma_{k} \sin\left(\frac{2\pi k t}{T}\right) \right) + \epsilon_t
$$
</div><br>
Where:

- $y_t$: The observed value at time $t$.
- $\beta_0$: The intercept or constant term in the model.
- $\beta_k$: The coefficient for the cosine term corresponding to the $k$-th harmonic.
- $\gamma_k$: The coefficient for the sine term corresponding to the $k$-th harmonic.
- $T$: The period of the data (e.g., the number of days in a year if the data is annual).
- $t$: The time point or index (often representing the day of the year, etc.).
- $K$: The total number of harmonics (sinusoidal terms) included in the model, usually based on the periodicity of the data.
- $\epsilon_t$: The error term at time $t$, capturing the residual variability in the data that is not explained by the harmonic components.

## Download and clean all required data

### Install and load necessary packages

```{r, message=F, warning=F}
library(terra)
library(ggplot2)
library(sf)
library(leaflet)
library(RColorBrewer)
```

### Three mangrove species samples

```{r}
#read shapefiles of three mangrove species in Florida
black_mangrove <- st_read("data/SpeciesSamples/BM_Samples.shp")
white_mangrove <- st_read("data/SpeciesSamples/WM_Samples.shp")
red_mangrove <- st_read("data/SpeciesSamples/RM_Samples.shp")

crs_target <- st_crs(4326) # WGS 84
black_mangrove <- st_transform(black_mangrove, crs_target)
white_mangrove <- st_transform(white_mangrove, crs_target)
red_mangrove <- st_transform(red_mangrove, crs_target)

colors <- c("Black Mangrove" = "black", 
            "White Mangrove" = "white", 
            "Red Mangrove" = "red")

leaflet() %>%
  addTiles() %>%
  addCircleMarkers(data = black_mangrove, 
                   color = "black", 
                   radius = 5, 
                   popup = ~paste("Black Mangrove<br>", as.character(geometry))) %>%
  addCircleMarkers(data = white_mangrove, 
                   color = "white", 
                   radius = 5, 
                   popup = ~paste("White Mangrove<br>", as.character(geometry))) %>%
  addCircleMarkers(data = red_mangrove, 
                   color = "red", 
                   radius = 5, 
                   popup = ~paste("Red Mangrove<br>", as.character(geometry))) %>%
  addLegend("bottomright", 
            colors = colors, 
            labels = names(colors), 
            title = "Mangrove Samples")
```

```{r, results='asis'}

```

Add any additional processing steps here.

# Results

\[\~200 words\]

Tables and figures (maps and other graphics) are carefully planned to convey the results of your analysis. Intense exploration and evidence of many trials and failures. The author looked at the data in many different ways before coming to the final presentation of the data.

Show tables, plots, etc. and describe them.

```{r, fig.width=6, fig.height=3, fig.cap="Map of completely random data"}

```

```{r}

```

### Dygraphs Example

```{r}

```

# Conclusions

\[\~200 words\]

Clear summary adequately describing the results and putting them in context. Discussion of further questions and ways to continue investigation.

# References

All sources are cited in a consistent manner
